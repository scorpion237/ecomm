(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{27561:function(e,t,r){var n=r(67990),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},67990:function(e){var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},23279:function(e,t,r){var n=r(13218),i=r(7771),a=r(14841),c=Math.max,o=Math.min;e.exports=function(e,t,r){var l,s,d,u,m,h,f=0,g=!1,x=!1,v=!0;if("function"!=typeof e)throw TypeError("Expected a function");function invokeFunc(t){var r=l,n=s;return l=s=void 0,f=t,u=e.apply(n,r)}function shouldInvoke(e){var r=e-h,n=e-f;return void 0===h||r>=t||r<0||x&&n>=d}function timerExpired(){var e,r,n,a=i();if(shouldInvoke(a))return trailingEdge(a);m=setTimeout(timerExpired,(e=a-h,r=a-f,n=t-e,x?o(n,d-r):n))}function trailingEdge(e){return(m=void 0,v&&l)?invokeFunc(e):(l=s=void 0,u)}function debounced(){var e,r=i(),n=shouldInvoke(r);if(l=arguments,s=this,h=r,n){if(void 0===m)return f=e=h,m=setTimeout(timerExpired,t),g?invokeFunc(e):u;if(x)return clearTimeout(m),m=setTimeout(timerExpired,t),invokeFunc(h)}return void 0===m&&(m=setTimeout(timerExpired,t)),u}return t=a(t)||0,n(r)&&(g=!!r.leading,d=(x="maxWait"in r)?c(a(r.maxWait)||0,t):d,v="trailing"in r?!!r.trailing:v),debounced.cancel=function(){void 0!==m&&clearTimeout(m),f=0,l=h=s=m=void 0},debounced.flush=function(){return void 0===m?u:trailingEdge(i())},debounced}},33448:function(e,t,r){var n=r(44239),i=r(37005);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},7771:function(e,t,r){var n=r(55639);e.exports=function(){return n.Date.now()}},14841:function(e,t,r){var n=r(27561),i=r(13218),a=r(33448),c=0/0,o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,s=/^0o[0-7]+$/i,d=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return c;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=l.test(e);return r||s.test(e)?d(e.slice(2),r?2:8):o.test(e)?c:+e}},61742:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return r(79825)}])},36968:function(e,t,r){"use strict";r.d(t,{$h:function(){return getProductUrl},QG:function(){return getCategoryUrl},bJ:function(){return getCanonicalCategoryUrl},q2:function(){return getProductItemUrl},zy:function(){return getCanonicalProductUrl}});var n=r(29568);let i="/category",a="/product",getCategoryUrl=(e,t)=>{let r=e.custom_link||"".concat(i,"/").concat(e.url_key||e.category_id),a=t&&Object.keys(t).length?"?".concat((0,n.createGetStr)(t)):"";return"".concat(r).concat(a)},getCategoryItemUrl=(e,t)=>{var r;let a=(null===(r=e.props)||void 0===r?void 0:r.custom_link)||"".concat(i,"/").concat(e.url_key||e.category_id),c=t&&Object.keys(t).length?"?".concat((0,n.createGetStr)(t)):"";return"".concat(a).concat(c)},getProductUrl=(e,t)=>{let r="".concat(a,"/").concat(e.url_key||e.product_id),i=t&&Object.keys(t).length?"?".concat((0,n.createGetStr)(t)):"";return"".concat(r).concat(i)},getProductItemUrl=(e,t)=>{let r="".concat(a,"/").concat(e.url_key||e.product_id),i=t&&Object.keys(t).length?"?".concat((0,n.createGetStr)(t)):"";return"".concat(r).concat(i)},getCanonicalProductUrl=e=>"".concat("").concat(getProductItemUrl(e)),getCanonicalCategoryUrl=e=>"".concat("").concat(getCategoryItemUrl(e))},79825:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return w},default:function(){return CartPage}});var n=r(85893),i=r(67294),a=r(78089),c=r(70252),o=r(75002),l=r(23279),s=r.n(l),d=r(41664),u=r.n(d),m=r(59551),h=r(36968),f=r(55894),g=r(75077),x=r(88445),v=r(40280);function CartRow(e){var t,r,i,a,c,o,l,s;let{item:d,rmItem:p,onQtyChange:_}=e,{formatCurrency:y}=(0,v.Z)(),b=null===(r=d.vwItem)||void 0===r?void 0:null===(t=r.image)||void 0===t?void 0:t.path,j=(0,h.$h)(d.vwItem.product),C=b?(0,n.jsx)("img",{src:(0,m.mD)(b),alt:null===(a=d.vwItem)||void 0===a?void 0:null===(i=a.product)||void 0===i?void 0:i.title}):(0,n.jsx)(f.Z,{ratio:g.BT["1-1"],className:"bg-xs"});return(0,n.jsxs)("div",{className:"cart-item row",children:[(0,n.jsxs)("div",{className:"cart-item__description-col col-md-4",children:[(0,n.jsx)(u(),{href:j,className:"cart-item__img-link",children:C}),(0,n.jsxs)("div",{className:"cart-item__title",children:[(0,n.jsx)("div",{children:(0,n.jsx)(u(),{href:j,legacyBehavior:!0,children:(null===(o=d.vwItem)||void 0===o?void 0:null===(c=o.product)||void 0===c?void 0:c.title)||""})}),"variant"===d.vwItem.type&&(0,n.jsx)("div",{className:"text-muted",children:(null===(s=d.vwItem)||void 0===s?void 0:null===(l=s.variant)||void 0===l?void 0:l.title)||""})]})]}),(0,n.jsxs)("div",{className:"cart-item__col col-md-2",children:[(0,n.jsx)("span",{className:"cart-items__label",children:(0,n.jsx)("strong",{children:"Price: "})}),null!==d.itemPrice.final_price&&y(d.itemPrice.final_price)]}),(0,n.jsxs)("div",{className:"cart-item__col cart-item__col_qty col-md-2",children:[(0,n.jsx)("span",{className:"cart-items__label",children:(0,n.jsx)("strong",{children:"Qty: "})}),(0,n.jsxs)("div",{className:"cart-item__qty-input input-group input-group-sm",children:[(0,n.jsx)("button",{className:"btn btn-outline-secondary text-center",type:"button",style:{width:25},disabled:d.qty<2,onClick:()=>_(d.qty-1),children:(0,n.jsx)(n.Fragment,{children:"â€“"})}),(0,n.jsx)("input",{type:"number",className:"form-control form-control-sm text-center",name:"qty[".concat(d.item_id,"]"),value:d.qty,min:1,onChange:e=>_(Number(e.target.value)||0)}),(0,n.jsx)("button",{className:"btn btn-outline-secondary text-center",type:"button",style:{width:25},onClick:()=>_(d.qty+1),children:"+"})]})]}),(0,n.jsxs)("div",{className:"cart-item__col col-md-2",children:[(0,n.jsx)("span",{className:"cart-items__label",children:(0,n.jsx)("strong",{children:"Total: "})}),null!==d.itemPrice.final_price&&y((0,x.H)(d.itemPrice.final_price,d.qty))]}),(0,n.jsx)("div",{className:"cart-item__col cart-item__col_rm col-md-2",children:(0,n.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:p,children:"Remove"})})]})}var p=r(99603),_=r(20084),y=r(11163);function CartItems(e){let{items:t,setItems:r,total:l}=e,d=(0,a.T)(),u=(0,i.useRef)([]),m=(0,i.useRef)(!1),h=(0,a.C)(e=>e.cart.cartId),[f,g]=(0,i.useState)(!1),x=(0,y.useRouter)(),checkBgSubmits=()=>{let e=u.current.length;e&&m.current&&(g(!0),Promise.allSettled(u.current).then(()=>{u.current.length===e&&(g(!1),u.current=[])}))},rmItem=e=>{if(!h||!confirm("Are you sure?"))return;g(!0);let t=c.x.cart.removeFromCart(h,[e]).then(()=>checkBgSubmits());u.current.push(t),d((0,o.mj)(t)),r(t=>t.filter(t=>t.item_id!==e))},submitQty=async(e,t)=>{if(!h)return;let r=c.x.cart.setCartItemsQty(h,[{item_id:e,qty:t}]).then(()=>checkBgSubmits());u.current.push(r)},v=(0,i.useMemo)(()=>s()((e,t)=>submitQty(e,t),700,{leading:!0}),[]),onQtyChange=(e,t)=>{g(!0),v(e,t),r(r=>{let n=[...r],i=n.findIndex(t=>t.item_id===e);return i>=0&&(n[i].qty=t),n})};return(0,i.useEffect)(()=>(m.current=!0,()=>{m.current=!1}),[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"cart-items",children:[(0,n.jsxs)("div",{className:"cart-items__thead row",children:[(0,n.jsx)("div",{className:"cart-items__thead-cell col-md-4"}),(0,n.jsx)("div",{className:"cart-items__thead-cell col-md-2",children:"Prix"}),(0,n.jsx)("div",{className:"cart-items__thead-cell col-md-2",children:"Qty"}),(0,n.jsx)("div",{className:"cart-items__thead-cell col-md-2",children:"Total"}),(0,n.jsx)("div",{className:"cart-items__thead-cell col-md-2"})]}),t.map(e=>(0,n.jsx)(CartRow,{item:e,rmItem:()=>rmItem(e.item_id),onQtyChange:t=>onQtyChange(e.item_id,t)},e.item_id)),(0,n.jsxs)("div",{className:"cart-items__total-row row",children:[(0,n.jsx)("div",{className:"cart-items__total-cell cart-items__total-cell_title col-md-6",children:"Commande Total:"}),(0,n.jsxs)("div",{className:"cart-items__total-cell col-md-2",children:[(0,n.jsx)("span",{className:"cart-items__label",children:"Qty: "}),l.qty]}),(0,n.jsxs)("div",{className:"cart-items__total-cell col-md-2",children:[(0,n.jsx)("span",{className:"cart-items__label",children:"Prix: "}),l.price]})]})]}),(0,n.jsx)("div",{className:"cart-items__actions",children:(0,n.jsxs)("button",{className:"btn btn-action btn-lg btn-anim",disabled:f,onClick:()=>x.push("/checkout"),children:["Valider ",(0,n.jsx)(p.G,{icon:_.sq})]})})]})}var b=r(21971),j=r(12118),C=r(87042),N=r(24561);function CartRowLoader(e){let{bg:t}=e;return(0,n.jsxs)("div",{className:"row mb-2 mx-1 py-3 rounded",style:{backgroundColor:t||"#fff"},children:[(0,n.jsx)("div",{className:"col-md-4 d-flex mb-2 align-items-start ",children:(0,n.jsxs)(N.ZP,{speed:2,width:230,height:60,viewBox:"0 0 240 70",backgroundColor:t?"#d3d3d3":"#f3f3f3",foregroundColor:t?"#ababab":"#ecebeb",children:[(0,n.jsx)("rect",{x:"75",y:"15",rx:"3",ry:"3",width:"158",height:"12"}),(0,n.jsx)("rect",{x:"75",y:"35",rx:"3",ry:"3",width:"100",height:"12"}),(0,n.jsx)("rect",{x:"0",y:"10",rx:"3",ry:"3",width:"60",height:"60"})]})}),(0,n.jsx)("div",{className:"col-md-2 text-start text-md-center mb-2 py-1 px-4 px-md-0",children:(0,n.jsx)(SmallLoader,{bg:t})}),(0,n.jsx)("div",{className:"col-md-2 text-start text-md-center mb-2 py-1 px-4 px-md-0",children:(0,n.jsx)(SmallLoader,{bg:t})}),(0,n.jsx)("div",{className:"col-md-2 text-start text-md-center mb-2 py-1 px-4 px-md-0",children:(0,n.jsx)(SmallLoader,{bg:t})})]})}let SmallLoader=e=>{let{bg:t}=e;return(0,n.jsx)(N.ZP,{speed:2,width:60,height:20,viewBox:"0 0 60 20",backgroundColor:t?"#d3d3d3":"#f3f3f3",foregroundColor:t?"#ababab":"#ecebeb",children:(0,n.jsx)("rect",{x:"0",y:"10",rx:"3",ry:"3",width:"60",height:"10"})})};function CartLoader(){return(0,n.jsx)("div",{className:"pt-md-4",children:[void 0,void 0,void 0].map((e,t)=>(0,n.jsx)(CartRowLoader,{bg:t%2==0?"#f9f9f9":""},t))})}var w=!0;function CartPage(e){let{mainMenu:t,footerMenu:r,basicSettings:i}=e,{cartInited:a}=(0,C.j)(),c=(0,y.useRouter)(),{items:o,setItems:l,loading:s,total:d}=useCartItems();return(0,n.jsx)(b.Z,{mainMenu:t,footerMenu:r,basicSettings:i,noIndex:!0,children:(0,n.jsx)("div",{className:"container",children:(0,n.jsx)("div",{className:"cart-page row",children:(0,n.jsxs)("div",{className:"col-lg-8 offset-lg-2",children:[c.query.error&&(0,n.jsx)("div",{className:"alert alert-danger",role:"alert",children:c.query.error}),(0,n.jsx)("h1",{className:"page-heading page-heading_h1  page-heading_m-h1",children:"Panier"}),(0,n.jsx)("div",{className:"cart-page__content",children:s||a===j._H.processing?(0,n.jsx)(CartLoader,{}):o.length>0?(0,n.jsx)(CartItems,{items:o,setItems:l,total:d}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"cart-page__warning",children:"Votre panier est vide."}),(0,n.jsx)("p",{className:"cart-page__warning",children:(0,n.jsx)(u(),{href:"/",className:"btn btn-success",children:"Faire des courses"})})]})})]})})})})}let useCartItems=()=>{let e=(0,a.T)(),{id:t}=(0,C.j)(),[r,n]=(0,i.useState)([]),[l,s]=(0,i.useState)(!1),d=(0,i.useCallback)(t=>{s(!0);let r=c.x.cart.getCartItems(t).then(t=>{let{cart:r,items:i}=t;n(i),e((0,j.YP)(r.total))}).catch(e=>console.error(e)).finally(()=>s(!1));e((0,o.mj)(r))},[e]);(0,i.useEffect)(()=>{t&&d(t)},[t,d]);let u=(0,i.useMemo)(()=>(0,x.t)(r.map(e=>({qty:e.qty,price:(0,x.H)(e.itemPrice.final_price,e.qty)}))),[r]);return(0,i.useEffect)(()=>{e((0,j.YP)({qty:u.qty,total:u.price}))},[u,e]),{items:r,setItems:n,loading:l,total:u}}},24561:function(e,t,r){"use strict";var n=r(67294),__assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},SVG=function(e){var t=e.animate,r=void 0===t||t,i=e.animateBegin,a=e.backgroundColor,c=void 0===a?"#f5f6f7":a,o=e.backgroundOpacity,l=void 0===o?1:o,s=e.baseUrl,d=void 0===s?"":s,u=e.children,m=e.foregroundColor,h=e.foregroundOpacity,f=e.gradientRatio,g=void 0===f?2:f,x=e.gradientDirection,v=e.uniqueKey,p=e.interval,_=e.rtl,y=e.speed,b=e.style,j=void 0===b?{}:b,C=e.title,N=void 0===C?"Loading...":C,w=e.beforeMask,k=void 0===w?null:w,E=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}(e,["animate","animateBegin","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","gradientDirection","uniqueKey","interval","rtl","speed","style","title","beforeMask"]),P=v||Math.random().toString(36).substring(6),I=P+"-diff",O=P+"-animated-diff",S=P+"-aria",q="0; "+(void 0===p?.25:p)+"; 1",T=(void 0===y?1.2:y)+"s";return(0,n.createElement)("svg",__assign({"aria-labelledby":S,role:"img",style:__assign(__assign({},j),void 0!==_&&_?{transform:"scaleX(-1)"}:null)},E),N?(0,n.createElement)("title",{id:S},N):null,k&&(0,n.isValidElement)(k)?k:null,(0,n.createElement)("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%",clipPath:"url("+d+"#"+I+")",style:{fill:"url("+d+"#"+O+")"}}),(0,n.createElement)("defs",null,(0,n.createElement)("clipPath",{id:I},u),(0,n.createElement)("linearGradient",{id:O,gradientTransform:"top-bottom"===(void 0===x?"left-right":x)?"rotate(90)":void 0},(0,n.createElement)("stop",{offset:"0%",stopColor:c,stopOpacity:l},r&&(0,n.createElement)("animate",{attributeName:"offset",values:-g+"; "+-g+"; 1",keyTimes:q,dur:T,repeatCount:"indefinite",begin:i})),(0,n.createElement)("stop",{offset:"50%",stopColor:void 0===m?"#eee":m,stopOpacity:void 0===h?1:h},r&&(0,n.createElement)("animate",{attributeName:"offset",values:-g/2+"; "+-g/2+"; "+(1+g/2),keyTimes:q,dur:T,repeatCount:"indefinite",begin:i})),(0,n.createElement)("stop",{offset:"100%",stopColor:c,stopOpacity:l},r&&(0,n.createElement)("animate",{attributeName:"offset",values:"0; 0; "+(1+g),keyTimes:q,dur:T,repeatCount:"indefinite",begin:i})))))},ContentLoader=function(e){return e.children?(0,n.createElement)(SVG,__assign({},e)):(0,n.createElement)(ReactContentLoaderFacebook,__assign({},e))},ReactContentLoaderFacebook=function(e){return(0,n.createElement)(ContentLoader,__assign({viewBox:"0 0 476 124"},e),(0,n.createElement)("rect",{x:"48",y:"8",width:"88",height:"6",rx:"3"}),(0,n.createElement)("rect",{x:"48",y:"26",width:"52",height:"6",rx:"3"}),(0,n.createElement)("rect",{x:"0",y:"56",width:"410",height:"6",rx:"3"}),(0,n.createElement)("rect",{x:"0",y:"72",width:"380",height:"6",rx:"3"}),(0,n.createElement)("rect",{x:"0",y:"88",width:"178",height:"6",rx:"3"}),(0,n.createElement)("circle",{cx:"20",cy:"20",r:"20"}))};t.ZP=ContentLoader}},function(e){e.O(0,[878,660,199,971,774,888,179],function(){return e(e.s=61742)}),_N_E=e.O()}]);